{"version":3,"sources":["js/elem2d.js","js/utils.js","js/square.js","js/circle.js","js/main.js","../../../../Programs/nvm/nvm/v12.16.1/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Elem2D","ctx","Error","p1","p2","lineFromTwoPoints","m","n","vectorFromTwoPoints","dot","v1","v2","reduce","acc","v","i","distanceBetweenTwoPoints","w","h","Math","sqrt","calcLinesCollision","line1","line2","l","x","y","vectorEquals","calcSegmentsCollision","p3","p4","segment1","segment2","coll","dotSegment1","dotPoint1","dotSegment2","dotPoint2","Square","save","strokeStyle","strokeRect","restore","hp","filter","length","indexOfLowest","map","Infinity","Circle","r","arc","PI","stroke","ANIM","window","addEventListener","canvas","document","getElementById","getContext","CANVAS_WIDTH","CANVAS_HEIGHT","HALF_PI","CHAR_SIZE","char_position","MAP","init","requestAnimationFrame","draw","fillStyle","lineWidth","figure","fillRect","raycast","origin","rayCount","raySize","firstVector","angle","firstEnd","rayEnd","thisAngle","vector","rotateVector","dest","clampY","clampX","vecAdd","vecMulScalar","collidedDest","object","collidedDistance","collidesWithLine","newCollDist","beginPath","moveTo","lineTo","fill","scalar","a","start","vectors","push","vec","forEach","max","min","c","cos","s","sin","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"main.fb6bbcaf.js","sourceRoot":"..\\src","sourcesContent":["// abstract\r\nexport default class Elem2D {\r\n    constructor() {\r\n\r\n    }\r\n\r\n    draw(ctx) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n\r\n    collidesWithLine(p1, p2) {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n}","export function lineFromTwoPoints(p1, p2) {\r\n    if (p2[0] === p1[0]) {\r\n        // line is x = N\r\n        return [ null, p1[0] ];\r\n    } else {\r\n        let m = (p2[1] - p1[1]) / (p2[0] - p1[0]);\r\n        let n = p1[1] - (m * p1[0]);\r\n        return [ m, n ];\r\n    }\r\n}\r\n\r\nexport function vectorFromTwoPoints(p1, p2) {\r\n    return [ p2[0] - p1[0], p2[1] - p1[1] ];\r\n}\r\n\r\nexport function dot(v1, v2) {\r\n    return v1.reduce((acc, v, i) => {\r\n        return acc + v * v2[i];\r\n    }, 0);\r\n}\r\n\r\nexport function distanceBetweenTwoPoints(p1, p2) {\r\n    let w = p2[0] - p1[0];\r\n    let h = p2[1] - p1[0];\r\n    return Math.sqrt(w * w + h * h);\r\n}\r\n\r\nexport function calcLinesCollision(line1, line2) {\r\n    /* cases:\r\n        normal: m != null && m != 0\r\n        2 of x = n (m === null)\r\n        2 of y = n (m === 0)\r\n        1 normal, 1 of x = n\r\n        1 normal, 1 of y = n\r\n        1 of x = n, 1 of y = n => point is [x,y]\r\n        cases of y = n can be treated as normal so we got special cases for:\r\n        2 of x = n => since m1 = null & m2 = null they go through \"same line\" branch (todo pending)\r\n        1 of x = n and 1 normal => we check!\r\n\r\n    */\r\n    if (line1[0] === line2[0]) {\r\n        return false; // nunca se cruzan \r\n        // TODO: o son la misma!!!!!\r\n    } else if (line1[0] === null || line2[0] === null) { // any x = n???\r\n        // we treat line2 as x = n\r\n        if (line1[0] === null) { // so we swap if necessary\r\n            let l = line2;\r\n            line2 = line1;\r\n            line1 = l;\r\n        }\r\n        let x = line2[1]; // okay...\r\n        let y = x * line1[0] + line1[1]; // okay!\r\n        return [ x, y ];\r\n    } else {\r\n        let x = (line2[1] - line1[1]) / line1[0] - line2[0];\r\n        let y = x * line1[0] + line1[1];\r\n        return [ x, y ];\r\n    }\r\n}\r\n\r\nexport function vectorEquals(p1, p2) {\r\n    return p1[0] === p2[0] && p1[1] === p2[2];\r\n}\r\n\r\n// line1 = { p1, p2 } -- line2 = { p3, p4}\r\nexport function calcSegmentsCollision(p1, p2, p3, p4) {\r\n    let segment1 = lineFromTwoPoints(p1, p2);\r\n    let segment2 = lineFromTwoPoints(p3, p4);\r\n\r\n    let coll = calcLinesCollision(segment1, segment2);\r\n    if (!coll) return null;\r\n    // This next line is redundant with checks done below\r\n    // however it's like this due to JS round errors.\r\n    // TODO: Implement a better vector comparison method\r\n    if (vectorEquals(p1, coll) || vectorEquals(p2, coll) || vectorEquals(p3, coll) || vectorEquals(p4, coll)) {\r\n        return coll;\r\n    }\r\n\r\n    // is coll in segment1 and segment2?\r\n    let v1 = vectorFromTwoPoints(p1, p2);\r\n    let dotSegment1 = dot(v1, v1);\r\n    let dotPoint1 = dot(v1, vectorFromTwoPoints(p1, coll));\r\n    if (dotPoint1 === 0) {\r\n        // coll = p1\r\n        // Because of JS float aproximations (and vectorEquals not including a delta for float aproximation)\r\n        // we check here and just return p1 as the coll point\r\n        return p1;\r\n    } else if (dotPoint1 === dotSegment1) { // what if dotPoint1 ≈ dogSegment1? May return false negatives\r\n        return p2;\r\n    }\r\n    if (dotPoint1 < 0) return null; // does not belong to segment1, so can't be valid\r\n    if (dotPoint1 > dotSegment1) return null; // does not belong to segment1, so coll is not valid\r\n\r\n    let v2 = vectorFromTwoPoints(p3, p4);\r\n    let dotSegment2 = dot(v2, v2);\r\n    let dotPoint2 = dot(v2, vectorFromTwoPoints(p3, coll));\r\n    if (dotPoint2 === 0) {\r\n        return p3;\r\n    } else if (dotSegment2 === dotPoint2) {\r\n        return p4;\r\n    }\r\n    if (dotPoint2 < 0) return null; // does not belong to segment2, so can't be valid\r\n    if (dotPoint2 < dotSegment2) return coll; // belongs segment2 (and belongs to segment1 because of dotPoint < dotSegment1)\r\n\r\n    return null;\r\n}","import Elem2D from \"./elem2d\";\r\nimport { calcSegmentsCollision, distanceBetweenTwoPoints } from \"./utils\";\r\n\r\nexport default class Square extends Elem2D {\r\n    constructor(x, y, w, h) {\r\n        super();\r\n        this.x = x;\r\n        this.y = y;\r\n        this.w = w;\r\n        this.h = h;\r\n    }\r\n\r\n    draw(ctx) {\r\n        ctx.save();\r\n\r\n        ctx.strokeStyle = \"#F00\";\r\n        ctx.strokeRect(this.x, this.y, this.w, this.h);\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n    collidesWithLine(p1, p2) {\r\n        // p1 y p2 es un timo!\r\n        // hits any line hitting the square?\r\n        let hp = [0, 0, 0, 0];\r\n        hp[0] = calcSegmentsCollision(p1, p2, [ this.x, this.y ],          [ this.x + this.w, this.y ])          ; /* top */\r\n        hp[1] = calcSegmentsCollision(p1, p2, [ this.x + this.w, this.y ], [ this.x + this.w, this.y + this.h ]) ; /* right */\r\n        hp[2] = calcSegmentsCollision(p1, p2, [ this.x, this.y + this.h ], [ this.x + this.w, this.y + this.h ]) ; /* bottom */\r\n        hp[3] = calcSegmentsCollision(p1, p2, [ this.x, this.y ],          [ this.x, this.y + this.h ])          ;  /* left */\r\n\r\n        hp = hp.filter(v => v != null);\r\n        if (hp.length === 0) return null;\r\n        // Hay que devolver uno de los puntos de colisión...\r\n        // Vamos a devolver el más cercano a p1... por si acaso (uwu)\r\n\r\n        let indexOfLowest = -1;\r\n        hp.map(coll => distanceBetweenTwoPoints(p1, coll)).reduce((acc, v, i) => {\r\n            if (v < acc) {\r\n                indexOfLowest = i;\r\n                return v;\r\n            } else {\r\n                return acc;\r\n            }\r\n        }, Infinity)\r\n\r\n        return hp[indexOfLowest]; // point or null\r\n    }\r\n}","import Elem2D from \"./elem2d\";\r\nimport { calcSegmentsCollision, distanceBetweenTwoPoints } from \"./utils\";\r\n\r\nexport default class Circle extends Elem2D {\r\n    constructor(x, y, r) {\r\n        super();\r\n        this.x = x;\r\n        this.y = y;\r\n        this.r = r;\r\n    }\r\n\r\n    draw(ctx) {\r\n        ctx.save();\r\n\r\n        ctx.strokeStyle = \"#F00\";\r\n        ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);\r\n        ctx.stroke();\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n    collidesWithLine(p1, p2) {\r\n        return null;\r\n    }\r\n}","import Square from \"./square\";\r\nimport Circle from \"./circle\";\r\nimport { distanceBetweenTwoPoints } from \"./utils\";\r\n\r\nconst ANIM = false;\r\n\r\nwindow.addEventListener(\"load\", function() {\r\n\r\nlet canvas = document.getElementById(\"canvas\");\r\nlet ctx = canvas.getContext(\"2d\");\r\nconst CANVAS_WIDTH = 500;\r\nconst CANVAS_HEIGHT = 500;\r\nconst PI = Math.PI;\r\nconst HALF_PI = Math.PI / 2; // xd\r\n\r\nconst CHAR_SIZE = 5; // must be odd\r\n\r\nlet char_position = [ 150, 150 ];\r\n\r\nconst MAP = [\r\n    new Square(200, 200, 100, 100),\r\n    new Circle(100, 100, 50, 50),\r\n];\r\n\r\nfunction init() {\r\n    window.requestAnimationFrame(draw);\r\n}\r\n\r\nfunction draw() {\r\n\r\n    ctx.save();\r\n\r\n    // background\r\n    ctx.fillStyle = \"#DDD\";\r\n    ctx.strokeStyle = \"#000\";\r\n    ctx.lineWidth = 10;\r\n    ctx.strokeRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);\r\n    ctx.restore();\r\n\r\n    for (let figure of MAP) {\r\n        figure.draw(ctx);\r\n    }\r\n\r\n    // draw \"character\"\r\n    ctx.fillStyle = \"#000\";\r\n    ctx.fillRect( char_position[0] - (CHAR_SIZE - 1) / 2, char_position[0] - (CHAR_SIZE - 1) / 2, CHAR_SIZE, CHAR_SIZE);\r\n\r\n    ctx.fillStyle = \"#0FF\";\r\n    ctx.fillRect(char_position[0], char_position[1], 1, 1);\r\n    // raycast\r\n    raycast(char_position, 360, 200);\r\n\r\n    if (ANIM) window.requestAnimationFrame(draw);\r\n}\r\n\r\n// 3 <= rayCount <= 360;\r\nfunction raycast(origin, rayCount, raySize, firstVector = [ 1, 0 ]) {\r\n    // firstvector must be unitvector\r\n    ctx.save();\r\n    ctx.strokeStyle = \"#0F05\";\r\n    ctx.lineWidth = 1;\r\n    ctx.fillStyle = \"rgba(100, 100, 100, 0.5)\";\r\n\r\n    let angle = 2 * PI / rayCount;\r\n\r\n    let firstEnd;\r\n    let rayEnd;\r\n    for (let i = 0; i < rayCount; i++) {\r\n        let thisAngle = i * angle;\r\n        // TODO: No recalcular cos/sin... dado que es el mismo angulo se puede calcular 1 vez\r\n        let vector = rotateVector(firstVector, thisAngle);\r\n        let dest = clampY(clampX(vecAdd(origin, vecMulScalar(vector, raySize)), CANVAS_WIDTH), CANVAS_HEIGHT);\r\n\r\n        // collisions?\r\n        let collidedDest = null;\r\n        for (let object of MAP) {\r\n            let collidedDistance = Infinity;\r\n            let coll = object.collidesWithLine(origin, dest);\r\n            if (coll) {\r\n                // ¿Is the closest collision?\r\n                let newCollDist = distanceBetweenTwoPoints(origin, coll);\r\n                if (newCollDist < collidedDistance) {\r\n                    collidedDest = coll;\r\n                    collidedDistance = newCollDist;\r\n                }\r\n            }\r\n        }\r\n        if (collidedDest) {\r\n            ctx.save();\r\n            ctx.beginPath();\r\n            ctx.strokeStyle = \"#F00\";\r\n            ctx.moveTo(collidedDest[0], collidedDest[1]);\r\n            ctx.lineTo(dest[0], dest[1]);\r\n            ctx.stroke();\r\n            ctx.restore();\r\n            dest = collidedDest;\r\n        }\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(origin[0], origin[1]);\r\n        ctx.lineTo(dest[0], dest[1]);\r\n        ctx.stroke();\r\n        // draw zones in ray\r\n        if (rayEnd) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(origin[0], origin[1]);\r\n            ctx.lineTo(rayEnd[0], rayEnd[1]);\r\n            ctx.lineTo(dest[0], dest[1]);\r\n            ctx.lineTo(origin[0], origin[1]);\r\n            ctx.fill();\r\n        } else {\r\n            firstEnd = dest;\r\n        }\r\n        rayEnd = dest;\r\n    }\r\n    // another one to fill from first to last\r\n    ctx.beginPath();\r\n    ctx.moveTo(origin[0], origin[1]);\r\n    ctx.lineTo(rayEnd[0], rayEnd[1]);\r\n    ctx.lineTo(firstEnd[0], firstEnd[1]);\r\n    ctx.lineTo(origin[0], origin[1]);\r\n    ctx.fill();\r\n\r\n    ctx.restore();\r\n}\r\n\r\nfunction vecMulScalar(vector, scalar) {\r\n    return vector.map(a => a * scalar);\r\n}\r\n\r\nfunction vecAdd(...vectors) {\r\n    let start = [];\r\n    for (let i = 0; i < vectors[0].length; i++) start.push(0);\r\n    return vectors.reduce((acc, vec) => {\r\n        vec.forEach((v, i) => { acc[i] += v; });\r\n        return acc;\r\n    }, start);\r\n}\r\n\r\nfunction clampX(vector, max, min = 0) {\r\n    let v = [ vector[0], vector[1] ];\r\n    if (v[0] > max) {\r\n        v[0] = max;\r\n    } else if(v[0] < min) {\r\n        v[0] = min;\r\n    }\r\n    return v;\r\n}\r\n\r\nfunction clampY(vector, max, min = 0) {\r\n    let v = [ vector[0], vector[1] ];\r\n    if (v[1] > max) {\r\n        v[1] = max;\r\n    } else if(v[1] < min) {\r\n        v[1] = min;\r\n    }\r\n    return v;\r\n}\r\n\r\n// anti-clockwise\r\nfunction rotateVector(vector, angle) {\r\n    let c = Math.cos(-angle);\r\n    let s = Math.sin(-angle);\r\n    return [ c * vector[0] - s * vector[1], s * vector[0] + c * vector[1] ];\r\n    // x2 = cos(β)·x1 − sin(β)·y1\r\n    // y2 = sin(β)·x1 + cos(β)·y1\r\n}\r\n\r\ninit();\r\n    \r\n}); // window load","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}